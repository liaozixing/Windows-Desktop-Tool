使用该软件时请先阅读 `Windows Desktop Tool\requirements.txt` 免责声明文件

#  Windows 桌面工具 ( Windows Desktop Tool)

**版本：v1.1.9** (更新日期: 2026-01-18)

一个基于 Python 和 PyQt-Fluent-Widgets 开发的现代化 Windows 桌面实用工具集。该工具集集成网络信息查询、网速测试、文件粉碎、万能格式转换、窗口定位工具、系统快捷工具等功能，并具备完善的**实时网络监控**与**离线支持**机制。

## 🛠️ 最近更新 (v1.1.9)
- **系统信息展示深度优化**：
  - **显卡型号精准识别**：修复了显卡型号仅显示品牌的局限，现在可显示具体型号（如 NVIDIA GeForce RTX 4060）。
  - **异步加载机制**：引入后台线程扫描硬件信息，彻底解决点击“本机配置信息”时界面卡顿、加载缓慢的问题。
  - **磁盘识别优化**：优化了 SSD/HDD 识别逻辑，增加缓存机制，提升扫描速度。
- **网络功能修复与增强**：
  - **详情获取修复**：修复了部分环境下 `netsh` 命令编码导致的“网络详情获取失败”问题。
  - **有线连接兼容**：增强了对有线网络环境的识别，避免在非 WiFi 环境下报错。
- **系统兼容性适配**：
  - **家庭版自动识别**：新增对 Windows 家庭版的智能识别。由于家庭版原生不支持组策略（gpedit.msc），程序将自动禁用该功能按钮并提供悬停文字提示，防止用户误操作。
- **新增免责声明强制确认 (v1.1.8)**：
  - **首次启动强制确认**：首次运行程序将强制弹出免责声明，用户同意后方可使用。
  - **拒绝即退出**：若用户拒绝声明或直接关闭窗口，程序将自动退出以确保合规。
  - **随时查看**：设置界面新增“查看免责声明”按钮，方便用户随时查阅法律条款。
- **文件粉碎工具优化**：
  - **路径显示优化**：支持超长路径自动省略（Ellipsis），悬停可查看完整路径，界面更整洁。
  - **右键菜单支持**：新增右键快捷菜单，支持“复制路径”、“打开文件位置”及“从列表中移除”。
  - **类型识别更精准**：优化了文件类型识别逻辑，可准确显示 Python、HTML、Word 等具体文档类型。
- **本机信息展示升级**：
  - **系统信息精简**：重构了硬件配置展示，信息更加直观易懂。
  - **Windows 11 适配**：修复了在 Windows 11 系统下可能错误显示为 Windows 10 的问题。
  - **磁盘深度识别**：新增磁盘类型识别（固态硬盘 SSD / 机械硬盘 HDD）及更清晰的容量统计。
- **窗口定位工具增强**：
  - **结束进程功能**：新增“结束进程”按钮，定位窗口后可一键强制关闭目标程序，方便处理死锁或流氓弹窗。
- **网络状态交互增强**：
  - **点击查看详情**：底部网络状态栏改为可点击状态，点击即可弹出详细的网络连接信息（本地 IP、SSID、信号强度等）。
- **界面细节优化**：
  - **移除冗余按钮**：移除了格式转换界面中失效的预览放大镜按钮。
  - **校验逻辑优化**：彻底解决文件粉碎时因深度校验导致的界面变卡问题。

## 🛠️ 环境要求

- **操作系统**: Windows 10/11 (推荐 Windows 11)
- **Python 版本**: Python 3.8 或更高版本
- **依赖库**:
  - `PyQt5`: 界面框架
  - `PyQt-Fluent-Widgets`: Fluent Design 风格组件库
  - `Pillow`: 图片处理与格式转换
  - `pdf2docx` / `docx2pdf`: PDF 与 Word 相互转换
  - `python-docx` / `pandas`: 文档表格提取与 Excel 处理
  - `psutil`: 系统进程信息获取
  - `speedtest-cli`: 网络测速核心

## 🚀 快速开始

### 1. 克隆或下载项目
将项目代码下载到本地目录。

### 2. 安装依赖
打开终端（CMD 或 PowerShell），进入项目根目录，运行以下命令安装所需依赖：

```bash
pip install -r requirements.txt
```

### 3. 启动程序
在项目根目录下运行以下命令即可启动：

```bash
python main.py
```

## 💡 功能说明

### 1. 🌐 网络信息查询
- **高精度定位**：自动获取当前公网 IP 地址。
- **详尽数据**：显示地理位置（省、市）、运营商信息及数据来源。
- **状态详情**：点击底部状态栏查看本地内网 IP、WiFi 名称及信号。

### 2. 🚀 可视化网速测试
- **动态仪表盘**：通过仪表盘实时展示下载与上传速度。
- **实时图表**：内置测速曲线图，直观反映网络波动。

### 3. 🧹 文件粉碎工具
- **强制删除**：支持粉碎被占用的文件或文件夹，自动尝试解除进程占用。
- **智能校验**：自动识别系统关键文件并保护，防止误删导致系统崩溃。
- **快捷操作**：支持右键复制路径、打开目录，支持长路径省略显示。

### 4. 🔍 窗口弹窗定位工具
- **实时识别**：拖动定位图标至任意窗口，实时显示窗口标题、句柄、PID 及所属进程路径。
- **进程管理**：支持一键定位文件、复制路径或**直接结束目标进程**。

### 5. 🛠️ 系统工具集成
- **快捷工具栏**：一键直达命令行、任务管理器、组策略（支持家庭版一键修复）、运行框、环境变量等。
- **配置看板**：清爽的硬件配置信息弹窗，涵盖 CPU、GPU、内存、SSD 状态等。

### 6. 🔄 万能格式转换
- **图片转换**：SVG 转 ICO/PNG，PNG/JPG/WebP/BMP 互转。
- **文档转换**：PDF 互转 Word，Excel 与 Word 数据互提。

## 📂 项目结构

```text
Windows-Desktop-Tool/
├── modules/                # 核心功能逻辑模块
│   ├── __init__.py         # 模块初始化
│   ├── file_converter.py   # 格式转换逻辑 (图片/文档)
│   ├── file_shredder.py    # 文件粉碎逻辑 (锁定检查/强制删除)
│   ├── ip_query.py         # IP 查询逻辑
│   ├── network_monitor.py  # 网络监控逻辑
│   ├── network_speed.py    # 网速测试逻辑
│   ├── settings.py         # 配置管理逻辑
│   ├── system_functions.py # 系统工具逻辑 (组策略修复/清理缓存)
│   ├── system_info.py      # 本机信息逻辑 (硬件识别)
│   └── window_tool.py      # 窗口定位逻辑
├── ui/                     # 用户界面实现模块
│   ├── __init__.py         # 模块初始化
│   ├── components.py       # 自定义 Fluent UI 组件
│   └── main_window.py      # 主窗口及各功能界面实现
├── utils/                  # 通用工具模块
│   └── __init__.py         # 模块初始化
├── app.ico                 # 程序图标
├── app.svg                 # 程序矢量图标
├── disclaimer.txt          # 免责声明文件
├── main.py                 # 程序入口 (高 DPI 适配/翻译加载)
├── README.md               # 项目说明文档
├── requirements.txt        # 依赖清单
└── settings.json           # 用户配置文件
```

---
*由 AI 辅助开发，致力于打造更便捷的 Windows 办公环境。*
