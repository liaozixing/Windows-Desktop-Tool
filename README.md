使用该软件时请先阅读 `Windows Desktop Tool\disclaimer.txt` 免责声明文件

#  Windows 桌面工具 ( Windows Desktop Tool)

**版本：v1.3.0** (更新日期: 2026-01-23)

一个基于 Python 和 PyQt-Fluent-Widgets 开发的现代化 Windows 桌面实用工具集。该工具集集成网络信息查询、网速测试、文件粉碎、万能格式转换、窗口定位工具、系统快捷工具等功能，并具备完善的**实时网络监控**与**离线支持**机制。

## 🛠️ 最近更新 (v1.3.0)
- **代码架构深度重构**：
  - **核心解耦**：将原本庞大且逻辑混杂的 `main_window.py` 彻底拆分为多个独立的界面接口文件（如 `speed_test_interface.py`, `ip_interface.py` 等），实现了主窗口与业务逻辑的解耦。
  - **模块化管理**：每个功能界面现在都是一个独立的 QWidget 子类，拥有自己的状态管理和资源清理逻辑，极大提升了代码的可维护性和团队协作效率。
  - **组件化升级**：界面组件（components）与核心业务逻辑（modules）完全分离，主窗口仅作为导航和容器使用。
- **打包运行逻辑优化**：
  - **消除冗余窗口**：修复了在打包成可执行文件后，调用命令行、组策略编辑器或打开文件位置时会额外弹出黑色命令窗口的问题。
  - **静默执行机制**：所有外部进程调用均通过 `CREATE_NO_WINDOW` 标志位实现静默运行，用户体验更加原生。
- **线程管理与退出清理**：
  - **统一清理模式**：为所有异步功能接口引入了 `stop_worker` 统一清理方法。
  - **优雅退出**：确保程序在关闭或通过托盘菜单退出时，能够瞬间停止所有后台测速、查询或转换线程，解决了进程残留问题。
- **稳定性修复**：
  - 修复了拆分后测速界面图表定时器未正确导入 `QTimer` 的潜在崩溃风险。
  - 优化了导航栏点击网络状态时的详情弹窗显示逻辑。

## 🛠️ 历史更新 (v1.2.0)
- **格式转换界面重构**：图片/文档/视频转换合并为“万能格式转换”，新增视频转换支持（基于 ffmpeg）。
- **配置路径迁移**：设置文件迁移至 `%APPDATA%`，解决权限导致的保存失败问题。
- **退出行为优化**：新增关闭确认对话框与“最小化到托盘”偏好记录。

## 🛠️ 环境要求

- **操作系统**: Windows 10/11 (推荐 Windows 11)
- **Python 版本**: Python 3.8 或更高版本
- **依赖库**:
  - `PyQt5`: 界面框架
  - `PyQt-Fluent-Widgets`: Fluent Design 风格组件库
  - `Pillow`: 图片处理与格式转换
  - `pdf2docx` / `docx2pdf`: PDF 与 Word 相互转换
  - `python-docx` / `pandas`: 文档表格提取与 Excel 处理
  - `psutil`: 系统进程信息获取
  - `speedtest-cli`: 网络测速核心

## 🚀 快速开始

### 1. 克隆或下载项目
将项目代码下载到本地目录。

### 2. 安装依赖
打开终端（CMD 或 PowerShell），进入项目根目录，运行以下命令安装所需依赖：

```bash
pip install -r requirements.txt
```

### 3. 启动程序
在项目根目录下运行以下命令即可启动：

```bash
python main.py
```

## 💡 功能说明

### 1. 🌐 网络信息查询
- **高精度定位**：自动获取当前公网 IP 地址。
- **详尽数据**：显示地理位置（省、市）、运营商信息及数据来源。
- **状态详情**：点击底部状态栏查看本地内网 IP、WiFi 名称及信号。

### 2. 🚀 可视化网速测试
- **动态仪表盘**：通过仪表盘实时展示下载与上传速度。
- **实时图表**：内置测速曲线图，直观反映网络波动。

### 3. 🧹 文件粉碎工具
- **强制删除**：支持粉碎被占用的文件或文件夹，自动尝试解除进程占用。
- **智能校验**：自动识别系统关键文件并保护，防止误删导致系统崩溃。
- **快捷操作**：支持右键复制路径、打开目录，支持长路径省略显示。

### 4. 🔍 窗口弹窗定位工具
- **实时识别**：拖动定位图标至任意窗口，实时显示窗口标题、句柄、PID 及所属进程路径。
- **进程管理**：支持一键定位文件、复制路径或**直接结束目标进程**。

### 5. 🛠️ 系统工具集成
- **快捷工具栏**：一键直达命令行、任务管理器、组策略（支持家庭版一键修复）、运行框、环境变量等。
- **配置看板**：清爽的硬件配置信息弹窗，涵盖 CPU、GPU、内存、SSD 状态等。

### 6. 🔄 万能格式转换
- **图片转换**：SVG 转 ICO/PNG，PNG/JPG/WebP/BMP 互转。
- **文档转换**：PDF 互转 Word，Excel 与 Word 数据互提。

## 📂 项目结构

```text
Windows-Desktop-Tool/
├── modules/                # 核心功能逻辑模块
│   ├── __init__.py         # 模块初始化
│   ├── file_converter.py   # 格式转换逻辑 (图片/文档)
│   ├── file_shredder.py    # 文件粉碎逻辑 (锁定检查/强制删除)
│   ├── ip_query.py         # IP 查询逻辑
│   ├── network_monitor.py  # 网络监控逻辑
│   ├── network_speed.py    # 网速测试逻辑
│   ├── settings.py         # 配置管理逻辑
│   ├── system_functions.py # 系统工具逻辑 (组策略修复/清理缓存)
│   ├── system_info.py      # 本机信息逻辑 (硬件识别)
│   └── window_tool.py      # 窗口定位逻辑
├── ui/                     # 用户界面实现模块
│   ├── __init__.py         # 模块初始化
│   ├── components.py       # 自定义 Fluent UI 组件
│   ├── main_window.py      # 主窗口逻辑 (导航管理、托盘管理)
│   ├── speed_test_interface.py # 网速测试界面 (含动态图表与仪表盘)
│   ├── ip_interface.py     # IP 查询界面 (含地理位置可视化)
│   ├── system_interface.py # 系统工具界面 (含组策略修复、硬件看板)
│   ├── shredder_interface.py # 文件粉碎界面 (含文件拖拽、保护校验)
│   ├── converter_interface.py # 格式转换界面 (图片/文档/视频统一入口)
│   ├── window_tool_interface.py # 窗口工具界面 (含定位十字准星)
│   ├── settings_interface.py # 软件设置界面 (主题切换、托盘偏好)
│   ├── disclaimer.py       # 免责声明界面 (含强制倒计时阅读)
│   ├── window_target.py    # 窗口定位实现 (十字准星与高亮框)
│   └── workers.py          # 通用异步工作线程实现
├── utils/                  # 通用工具模块
│   └── __init__.py         # 模块初始化
├── app.ico                 # 程序图标
├── app.svg                 # 程序矢量图标
├── disclaimer.txt          # 免责声明文件
├── main.py                 # 程序入口 (高 DPI 适配/翻译加载)
├── README.md               # 项目说明文档
├── requirements.txt        # 依赖清单
└── settings.json           # 用户配置文件
```

---

## 📜 开源协议说明

本项目采用 **GPL-3.0 开源协议** 发布。

这意味着：

1. 你可以自由使用、修改和分发本项目代码  
2. 如果你发布修改后的版本：
   - 必须 **公开源代码**
   - 必须 **继续使用 GPL-3.0 协议**
3. 可以用于商业用途  
   - 但仍需遵守 GPL 开源规则

*由 AI 辅助开发，致力于打造更便捷的 Windows 办公环境。*
