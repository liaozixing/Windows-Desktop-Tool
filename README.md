使用该软件时请先阅读 `Windows Desktop Tool\disclaimer.txt` 免责声明文件

#  Windows 桌面工具 ( Windows Desktop Tool)

**版本：v1.2.0** (更新日期: 2026-01-19)

一个基于 Python 和 PyQt-Fluent-Widgets 开发的现代化 Windows 桌面实用工具集。该工具集集成网络信息查询、网速测试、文件粉碎、万能格式转换、窗口定位工具、系统快捷工具等功能，并具备完善的**实时网络监控**与**离线支持**机制。

## 🛠️ 最近更新 (v1.2.0)
- **格式转换界面重构**：
  - **统一入口**：图片转换、文档转换合并为一个“万能格式转换”界面，通过“转换类型”下拉框在图片 / 文档 / 视频之间快速切换。
  - **文档转换优化**：文档转换第二步改为“目标格式”下拉框，支持在 Word / PDF / Excel 之间一键切换目标格式。
  - **新增视频转换**：新增“视频转换”页签，支持 MP4 / MKV / MOV / AVI 等常见格式，底层基于 `ffmpeg` 调用。
- **配置保存稳定性提升**：
  - **配置路径迁移**：将 `settings.json` 从程序目录迁移到 `%APPDATA%/UniversalWindowsDesktopTool/`，彻底避免因权限不足或被占用导致的“配置保存失败”提示。
  - **自动目录创建**：启动时会自动创建配置目录，保证首次运行也能顺利写入配置。
- **退出行为与托盘逻辑优化**：
  - **关闭确认对话框**：点击右上角关闭按钮时弹出“是否退出”确认框，避免误操作直接退出程序。
  - **托盘最小化选项**：在确认框中新增“点击关闭时最小化到系统托盘”复选框，可自由选择关闭行为，并自动记住用户偏好。
- **版本号自动同步**：
  - **标题栏自动更新**：程序启动时从本说明文档中解析 `版本：vX.Y.Z` 字段，窗口标题自动显示对应版本号，无需在代码中手动修改。
  - **格式兼容性**：若解析失败，会回退到内置默认版本，保证程序始终可正常显示。
- **免责声明安全性升级**：
  - **合规性增强**：引入强制 5 秒阅读倒计时，用户必须滑动到底部后方可点击“我已阅读并同意”。
  - **双重保障**：免责声明文本现已内置于代码中，即使外部 `disclaimer.txt` 文件丢失，程序仍能正常显示法律声明。
- **系统兼容性与图标优化**：
  - **图标显示修复**：针对 Windows 任务栏在部分环境下无法正确显示 SVG 图标的问题，现优先使用 `.ico` 格式图标，提供更完美的视觉体验。
  - **托盘图标同步**：系统托盘图标同步升级为高优先级 `.ico` 资源。
  - 修复在某些情况下程序关闭后仍残留后台进程、无法完全退出的问题，确保从主窗口关闭或通过托盘菜单退出时都能正确结束程序。

## 🛠️ 环境要求

- **操作系统**: Windows 10/11 (推荐 Windows 11)
- **Python 版本**: Python 3.8 或更高版本
- **依赖库**:
  - `PyQt5`: 界面框架
  - `PyQt-Fluent-Widgets`: Fluent Design 风格组件库
  - `Pillow`: 图片处理与格式转换
  - `pdf2docx` / `docx2pdf`: PDF 与 Word 相互转换
  - `python-docx` / `pandas`: 文档表格提取与 Excel 处理
  - `psutil`: 系统进程信息获取
  - `speedtest-cli`: 网络测速核心

## 🚀 快速开始

### 1. 克隆或下载项目
将项目代码下载到本地目录。

### 2. 安装依赖
打开终端（CMD 或 PowerShell），进入项目根目录，运行以下命令安装所需依赖：

```bash
pip install -r requirements.txt
```

### 3. 启动程序
在项目根目录下运行以下命令即可启动：

```bash
python main.py
```

## 💡 功能说明

### 1. 🌐 网络信息查询
- **高精度定位**：自动获取当前公网 IP 地址。
- **详尽数据**：显示地理位置（省、市）、运营商信息及数据来源。
- **状态详情**：点击底部状态栏查看本地内网 IP、WiFi 名称及信号。

### 2. 🚀 可视化网速测试
- **动态仪表盘**：通过仪表盘实时展示下载与上传速度。
- **实时图表**：内置测速曲线图，直观反映网络波动。

### 3. 🧹 文件粉碎工具
- **强制删除**：支持粉碎被占用的文件或文件夹，自动尝试解除进程占用。
- **智能校验**：自动识别系统关键文件并保护，防止误删导致系统崩溃。
- **快捷操作**：支持右键复制路径、打开目录，支持长路径省略显示。

### 4. 🔍 窗口弹窗定位工具
- **实时识别**：拖动定位图标至任意窗口，实时显示窗口标题、句柄、PID 及所属进程路径。
- **进程管理**：支持一键定位文件、复制路径或**直接结束目标进程**。

### 5. 🛠️ 系统工具集成
- **快捷工具栏**：一键直达命令行、任务管理器、组策略（支持家庭版一键修复）、运行框、环境变量等。
- **配置看板**：清爽的硬件配置信息弹窗，涵盖 CPU、GPU、内存、SSD 状态等。

### 6. 🔄 万能格式转换
- **图片转换**：SVG 转 ICO/PNG，PNG/JPG/WebP/BMP 互转。
- **文档转换**：PDF 互转 Word，Excel 与 Word 数据互提。

## 📂 项目结构

```text
Windows-Desktop-Tool/
├── modules/                # 核心功能逻辑模块
│   ├── __init__.py         # 模块初始化
│   ├── file_converter.py   # 格式转换逻辑 (图片/文档)
│   ├── file_shredder.py    # 文件粉碎逻辑 (锁定检查/强制删除)
│   ├── ip_query.py         # IP 查询逻辑
│   ├── network_monitor.py  # 网络监控逻辑
│   ├── network_speed.py    # 网速测试逻辑
│   ├── settings.py         # 配置管理逻辑
│   ├── system_functions.py # 系统工具逻辑 (组策略修复/清理缓存)
│   ├── system_info.py      # 本机信息逻辑 (硬件识别)
│   └── window_tool.py      # 窗口定位逻辑
├── ui/                     # 用户界面实现模块
│   ├── __init__.py         # 模块初始化
│   ├── components.py       # 自定义 Fluent UI 组件
│   └── main_window.py      # 主窗口及各功能界面实现
├── utils/                  # 通用工具模块
│   └── __init__.py         # 模块初始化
├── app.ico                 # 程序图标
├── app.svg                 # 程序矢量图标
├── disclaimer.txt          # 免责声明文件
├── main.py                 # 程序入口 (高 DPI 适配/翻译加载)
├── README.md               # 项目说明文档
├── requirements.txt        # 依赖清单
└── settings.json           # 用户配置文件
```

---

## 📜 开源协议说明

本项目采用 **GPL-3.0 开源协议** 发布。

这意味着：

1. 你可以自由使用、修改和分发本项目代码  
2. 如果你发布修改后的版本：
   - 必须 **公开源代码**
   - 必须 **继续使用 GPL-3.0 协议**
3. 可以用于商业用途  
   - 但仍需遵守 GPL 开源规则

*由 AI 辅助开发，致力于打造更便捷的 Windows 办公环境。*
